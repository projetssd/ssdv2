---
pgrole: 'ygege'
intport: '8715'
image: 'uwucode/ygege:develop'

pg_volumes:
  - "{{ settings.storage }}/docker/{{ lookup('env','USER') }}/{{ pgrole }}/config/config.json:/app/config.json:ro"
  - "{{ settings.storage }}/docker/{{ lookup('env','USER') }}/{{ pgrole }}/sessions:/app/sessions:rw"
  - '/etc/localtime:/etc/localtime:ro'

pg_env:
  PUID: "{{ lookup('env','MYUID') }}"
  PGID: "{{ lookup('env','MYGID') }}"
  HTTP_PROXY: "http://warp:1080"
  HTTPS_PROXY: "http://warp:1080"
  ALL_PROXY: "socks5://warp:1080"

specific_docker_info:
  capabilities:
    - NET_ADMIN
  security_opts:
    - apparmor:unconfined
  ports:
    - "8715:8715"
  restart_policy: "unless-stopped"
  log_driver: 'journald'
  log_options:
    tag: 'ygege'
  networks:
    - name: traefik_proxy
  healthcheck:
    test: >
      /bin/sh -c "
      wget -qO- --timeout=2 http://localhost:8715/health 2>/dev/null || exit 0
      "
    interval: "30s"
    timeout: "10s"
    retries: 3
    start_period: "10s"
