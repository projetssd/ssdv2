---
pgrole: 'ygege'
intport: '8715'
image: 'uwucode/ygege:develop'

pg_volumes:
  - "{{ settings.storage }}/docker/{{ lookup('env','USER') }}/{{ pgrole }}/config.json:/app/config.json:ro"
  - "{{ settings.storage }}/docker/{{ lookup('env','USER') }}/{{ pgrole }}/sessions:/app/sessions:rw"
  - '/etc/localtime:/etc/localtime:ro'

pg_env:
  PUID: "{{ lookup('env','MYUID') }}"
  PGID: "{{ lookup('env','MYGID') }}"

specific_docker_info:
  capabilities:
    - NET_ADMIN
  security_opts:
    - apparmor:unconfined
  ports:
    - "{{ intport }}:{{ intport }}"
  restart_policy: "unless-stopped"
  log_driver: 'journald'
  log_options:
    tag: 'ygege'
  networks:
    - name: traefik_proxy
  healthcheck:
    test: >
      /bin/sh -c "
      curl --fail http://localhost:{{ intport }}/health || exit 1
      "
    interval: "1m30s"
    timeout: "20s"
    retries: 3
    start_period: "10s"
